
create table insurance (insurance_num INT AUTO_INCREMENT PRIMARY KEY NOT NULL, insurance_id VARCHAR(20) UNIQUE NOT NULL, insurance_status TINYINT(1) NOT NULL DEFAULT 0, insurance_type ENUM('automobile', 'fire', 'driver', 'accident') NOT NULL, insurance_name VARCHAR(20) NOT NULL, insurance_description VARCHAR(300) NOT NULL, insurance_rate DOUBLE NOT NULL DEFAULT 1.0,  insurance_premium INT NOT NULL DEFAULT 10000);
create table automobile_insurance (insurance_data_num INT PRIMARY KEY AUTO_INCREMENT NOT NULL, insurance_id VARCHAR(20) NOT NULL, insurance_data JSON NOT NULL, CONSTRAINT fk_automobile_insurance FOREIGN KEY (insurance_id) REFERENCES insurance (insurance_id) ON DELETE CASCADE ON UPDATE CASCADE);
create table fire_insurance (insurance_id VARCHAR(20) NOT NULL, data_num INT PRIMARY KEY AUTO_INCREMENT NOT NULL, insurance_data JSON NOT NULL, CONSTRAINT fk_fire_insurance FOREIGN KEY (insurance_id) REFERENCES insurance (insurance_id) ON DELETE CASCADE ON UPDATE CASCADE);
create table driver_insurance (insurance_data_num INT PRIMARY KEY AUTO_INCREMENT NOT NULL, insurance_id VARCHAR(20) NOT NULL, insurance_data JSON NOT NULL, CONSTRAINT fk_driver_insurance FOREIGN KEY (insurance_id) REFERENCES insurance (insurance_id) ON DELETE CASCADE ON UPDATE CASCADE);
create table accident_insurance (insurance_data_num INT PRIMARY KEY AUTO_INCREMENT NOT NULL, insurance_id VARCHAR(20) NOT NULL, insurance_data JSON NOT NULL, CONSTRAINT fk_accident_insurance FOREIGN KEY (insurance_id) REFERENCES insurance (insurance_id) ON DELETE CASCADE ON UPDATE CASCADE);

create table client (client_num INT AUTO_INCREMENT PRIMARY KEY NOT NULL, client_id VARCHAR(20) UNIQUE NOT NULL, client_pw VARCHAR(20) NOT NULL, client_name VARCHAR(20) NOT NULL, client_rrn VARCHAR(20) UNIQUE NOT NULL, client_gender ENUM('man', 'woman') NOT NULL, client_age ENUM('twenty', 'thirty', 'forty', 'fifty', 'etc') NOT NULL, client_occupation ENUM('risk', 'non_risk') NOT NULL DEFAULT 'non_risk', client_phone VARCHAR(20) NOT NULL);
create table property (property_num INT AUTO_INCREMENT PRIMARY KEY NOT NULL, property_owner VARCHAR(20) NOT NULL, property_type ENUM('automobile', 'building') NOT NULL, property_id VARCHAR(20) UNIQUE NOT NULL, CONSTRAINT fk_property_owner FOREIGN KEY (property_owner) REFERENCES client(client_id) ON DELETE CASCADE ON UPDATE CASCADE);
create table automobile (property_num INT AUTO_INCREMENT PRIMARY KEY NOT NULL, automobile_owner VARCHAR(20) NOT NULL, automobile_id VARCHAR(20) NOT NULL, accident_grade ENUM('a', 'b', 'c') NOT NULL, automobile_type ENUM('compact', 'mid_size', 'full_size') NOT NULL, automobile_value INT NOT NULL DEFAULT 10000, CONSTRAINT fk_automobile_owner FOREIGN KEY (automobile_owner) REFERENCES property(property_owner) ON DELETE CASCADE ON UPDATE CASCADE, CONSTRAINT fk_automobile_id FOREIGN KEY (automobile_id) REFERENCES property(property_id) ON DELETE CASCADE ON UPDATE CASCADE);
create table building (property_num INT AUTO_INCREMENT PRIMARY KEY NOT NULL, building_owner VARCHAR(20) NOT NULL, building_id VARCHAR(20) NOT NULL, fire_grade ENUM('a', 'b', 'c') NOT NULL, building_type ENUM('house', 'store', 'office', 'factory') NOT NULL, building_floor INT NOT NULL DEFAULT 1, building_pyeong INT NOT NULL DEFAULT 1, building_value INT NOT NULL DEFAULT 10000, CONSTRAINT fk_building_owner FOREIGN KEY (building_owner) REFERENCES property(property_owner) ON DELETE CASCADE ON UPDATE CASCADE, CONSTRAINT fk_building_id FOREIGN KEY (building_id) REFERENCES property(property_id) ON DELETE CASCADE ON UPDATE CASCADE);

create table contract (contract_num INT AUTO_INCREMENT PRIMARY KEY NOT NULL, contract_status TINYINT(1) NOT NULL DEFAULT 0, contract_date DATETIME NOT NULL, contract_client_id VARCHAR(20) NOT NULL, contract_insurance_id VARCHAR(20) NOT NULL, contract_property_id VARCHAR(20), contract_rate DOUBLE NOT NULL DEFAULT 1.0, contract_premium INT NOT NULL DEFAULT 10000, CONSTRAINT fk_contract_client FOREIGN KEY (contract_client_id) REFERENCES client(client_id) ON DELETE CASCADE ON UPDATE CASCADE, CONSTRAINT fk_contract_insurance FOREIGN KEY (contract_insurance_id) REFERENCES insurance(insurance_id) ON DELETE CASCADE ON UPDATE CASCADE, CONSTRAINT fk_contract_property FOREIGN KEY (contract_property_id) REFERENCES property(property_id) ON DELETE CASCADE ON UPDATE CASCADE); 
create table payment (payment_num INT AUTO_INCREMENT PRIMARY KEY NOT NULL, contract_num INT NOT NULL, payment_status ENUM('unpaid', 'completed_payment') NOT NULL DEFAULT 'unpaid', payment_date DATETIME NULL, payment_amount INT NULL, CONSTRAINT fk_payment FOREIGN KEY (contract_num) REFERENCES contract(contract_num) ON DELETE CASCADE ON UPDATE CASCADE); 
create table claim (claim_num INT AUTO_INCREMENT PRIMARY KEY NOT NULL, contract_num INT NOT NULL, claim_status ENUM('unclaimed', 'requested_claim', 'under_examination', 'approved_claim', 'rejected_claim') NOT NULL DEFAULT 'unclaimed', claim_date DATETIME NULL, claim_amount INT NULL, payment_date DATETIME NULL, payment_amount INT NULL, CONSTRAINT fk_claim FOREIGN KEY (contract_num) REFERENCES contract(contract_num) ON DELETE CASCADE ON UPDATE CASCADE);

